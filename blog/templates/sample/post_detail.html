{% extends "sample/base.html" %}
{% load static %}
{% load humanize %}
{% load my_extras %}
{% load crispy_forms_tags %}
{% block title %}{{ post.title }} {% endblock %}
{% block content %}

    <section class="post-area section">
        <div class="container">

            <div class="row">

                <div class="col-lg-8 col-md-12 no-right-padding">

                    <div class="main-post">

                        <div class="blog-post-inner">

                            <div class="post-info">

                                <div class="left-area">
                                    <a class="avatar" href="{% url 'user_posts' post.author.username %}"><img
                                            src="{{ post.author.profile.image.url }}"
                                            alt="Profile Image"></a>
                                </div>

                                <div class="middle-area">
                                    <a class="name"
                                       href="{% url 'user_posts' post.author.username %}"><b>{{ post.author.first_name }} {{ post.author.last_name }}</b>
                                    </a>

                                    <h6 class="date">on {{ post.date_posted | date:"M d, Y" }}
                                        - {{ post.date_posted | naturaltime }}</h6>

                                    <a href="{% url 'category' post.category|lower %}" class="date">| Category: {{ post.category }}</a>
                                    <h6 class="date"> | {{ post.content | striptags | calculate_time_read }} min
                                        read </h6>
                                </div>

                                <div class="middle-area mt-1">
                                    {% if post.author == user %}
                                        <div>
                                            <a class="btn btn-secondary btn-sm mt-1 mb-1"
                                               href="{% url 'post_update' post.id %}">Update</a>
                                            <a class="btn btn-outline-danger btn-sm mt-1 mb-1"
                                               href="{% url 'post_delete' post.id %}">Delete</a>
                                        </div>
                                    {% endif %}
                                </div>

                            </div><!-- post-info -->

                            <h3 class="title"><b>{{ post.title }}</b></h3>

                            <p class="para">{{ post.content|safe }}</p>


                            <ul class="tags">
                                {% for tag in post.tags.all %}
                                    <li><a href="{% url 'post_tags' tag %}">{{ tag| title }}</a></li>
                                {% endfor %}
                            </ul>
                        </div><!-- blog-post-inner -->

                        <div class="post-icons-area">
                            <ul class="post-icons">
                                <li><a href="#"><i class="ion-heart"></i>57</a></li>
                                <li><a href="#"><i class="ion-chatbubble"></i>{{ comments.count }}</a></li>
                                <li><a href="#"><i class="ion-eye"></i>138</a></li>
                            </ul>

                            <ul class="icons">
                                <li>SHARE :</li>
                                <li><a href="#"><i class="ion-social-facebook"></i></a></li>
                                <li><a href="#"><i class="ion-social-twitter"></i></a></li>
                                <li><a href="#"><i class="ion-social-whatsapp"></i></a></li>
                            </ul>
                        </div>

                    </div><!-- main-post -->
                </div><!-- col-lg-8 col-md-12 -->
                {% include 'partials/_sidebar.html' %}
            </div>
        </div>
    </section>

    <div class="container mt-3 mb-2">
            <h2>{{ comments.count }} comments</h2>
            <hr>
            {% for comment in comments %}
                <div class="container" style="padding: 10px;">
                    <p class="font-weight-bold">
                        {{ comment.name }}
                        <span class=" text-muted font-weight-normal">
                              {{ comment.created_on }}
                            </span>
                    </p>
                    {{ comment.body | linebreaks }}
                </div>
            {% endfor %}
            <hr>
        </div>


        <div class="container card-body">
            {% if new_comment %}
                <div class="alert alert-success" role="alert">
                    Your comment is awaiting moderation
                </div>
            {% else %}
                <h3>Leave a Reply</h3>
                <span>Your email address will not be published. Required fields are marked *</span>
                <form method="post" style="margin-top: 1.3em;">
                    {{ comment_form | crispy }}
                    {% csrf_token %}
                    <button type="submit" class="btn btn-primary  btn-lg">Submit</button>
                </form>
            {% endif %}
        </div>


{% endblock %}